# å‰åç«¯å¯¹æ¥æŒ‡å—

## âœ… å·²å®Œæˆçš„é…ç½®

### åç«¯é…ç½®
- âœ… è¿è¡Œç«¯å£ï¼š`3000`
- âœ… æ•°æ®åº“ï¼šSQLite (`./backend/data/dev/bili-stats-dev.db`)
- âœ… ç¯å¢ƒé…ç½®ï¼š`.env.development`
- âœ… å¯åŠ¨å‘½ä»¤ï¼š`npm run dev`

### å‰ç«¯é…ç½®
- âœ… è¿è¡Œç«¯å£ï¼š`5173`
- âœ… API ä»£ç†ï¼š`/api` â†’ `http://localhost:38080`
- âœ… ç¯å¢ƒé…ç½®ï¼š`.env.development`
- âœ… Mock æ•°æ®ï¼š**å·²ç¦ç”¨**
- âœ… å¯åŠ¨å‘½ä»¤ï¼š`npm run dev`

---

## ğŸš€ å¯åŠ¨æ­¥éª¤

### 1. å¯åŠ¨åç«¯æœåŠ¡

```bash
cd backend
npm run dev
```

**é¢„æœŸè¾“å‡º**ï¼š
```
âœ… Loaded .env.development
âœ… æ•°æ®åº“è¡¨å·²å­˜åœ¨
âœ… ç®¡ç†å‘˜è´¦å·å·²å­˜åœ¨
âœ… ç³»ç»Ÿè®¾ç½®å·²åˆå§‹åŒ–
ğŸš€ Server running on http://localhost:38080
```

### 2. å¯åŠ¨å‰ç«¯æœåŠ¡

åœ¨**æ–°çš„ç»ˆç«¯**ä¸­ï¼š
```bash
cd frontend/web
npm run dev
```

**é¢„æœŸè¾“å‡º**ï¼š
```
  VITE v5.x.x  ready in xxx ms

  âœ  Local:   http://localhost:5173/
  âœ  Network: use --host to expose
```

### 3. è®¿é—®åº”ç”¨

åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼šhttp://localhost:5173/

---

## ğŸ” éªŒè¯å¯¹æ¥æˆåŠŸ

### æ–¹æ³• 1ï¼šæ£€æŸ¥ç½‘ç»œè¯·æ±‚

1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
2. åˆ‡æ¢åˆ° **Network** æ ‡ç­¾
3. åˆ·æ–°é¡µé¢
4. æŸ¥çœ‹ API è¯·æ±‚ï¼š
   - âœ… è¯·æ±‚ URL åº”è¯¥æ˜¯ `http://localhost:5173/api/v1/...`
   - âœ… çŠ¶æ€ç åº”è¯¥æ˜¯ `200` æˆ– `401`ï¼ˆæœªç™»å½•ï¼‰
   - âœ… å“åº”æ ¼å¼ï¼š`{ code: 0, data: {...}, message: "..." }`

### æ–¹æ³• 2ï¼šä½¿ç”¨æ§åˆ¶å°æµ‹è¯•

åœ¨æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12 â†’ Consoleï¼‰ä¸­æ‰§è¡Œï¼š

```javascript
// æµ‹è¯• GET è¯·æ±‚
await __http_get('/api/v1/settings')

// æµ‹è¯• POST è¯·æ±‚
await __http_post('/api/v1/auth/login', {
  username: 'admin',
  password: 'admin123'
})
```

### æ–¹æ³• 3ï¼šç™»å½•æµ‹è¯•

1. åœ¨ç™»å½•é¡µé¢è¾“å…¥ï¼š
   - **ç”¨æˆ·å**ï¼š`admin`
   - **å¯†ç **ï¼š`admin123`
2. ç‚¹å‡»ç™»å½•
3. âœ… æˆåŠŸï¼šè¿›å…¥ä»ªè¡¨ç›˜
4. âŒ å¤±è´¥ï¼šæ£€æŸ¥åç«¯æ˜¯å¦è¿è¡Œ

---

## ğŸ“Š API ç«¯ç‚¹è¯´æ˜

| æ¨¡å— | ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ |
|-----|------|------|------|
| è®¤è¯ | `/api/v1/auth/login` | POST | ç”¨æˆ·ç™»å½• |
| ä»»åŠ¡ | `/api/v1/tasks` | GET | è·å–ä»»åŠ¡åˆ—è¡¨ |
| ä»»åŠ¡ | `/api/v1/tasks` | POST | åˆ›å»ºä»»åŠ¡ |
| è´¦å· | `/api/v1/accounts` | GET | è·å–è´¦å·åˆ—è¡¨ |
| æŒ‡æ ‡ | `/api/v1/metrics/video/:bv` | GET | è·å–è§†é¢‘æŒ‡æ ‡ |
| é€šçŸ¥ | `/api/v1/notifications/rules` | GET | è·å–é€šçŸ¥è§„åˆ™ |
| è®¾ç½® | `/api/v1/settings` | GET | è·å–ç³»ç»Ÿè®¾ç½® |
| æ—¥å¿— | `/api/v1/logs` | GET | è·å–ç³»ç»Ÿæ—¥å¿— |

---

## âš™ï¸ é…ç½®æ–‡ä»¶è¯´æ˜

### åç«¯ï¼š`backend/.env.development`

```bash
NODE_ENV=development
PORT=3000                                    # åç«¯ç«¯å£
SQLITE_PATH=./data/dev/bili-stats-dev.db    # æ•°æ®åº“è·¯å¾„
JWT_SECRET=...                               # JWT å¯†é’¥
CORS_ORIGIN=http://localhost:5173,...       # å…è®¸çš„å‰ç«¯åœ°å€
```

### å‰ç«¯ï¼š`frontend/web/.env.development`

```bash
VITE_API_BASE_URL=http://localhost:38080     # åç«¯åœ°å€
VITE_PORT=5173                               # å‰ç«¯ç«¯å£
VITE_ENABLE_MOCK=false                       # ç¦ç”¨ Mock
```

### å‰ç«¯ï¼š`frontend/web/vite.config.ts`

```typescript
export default defineConfig({
  server: {
    port: 5173,
    proxy: {
      '/api': {
        target: 'http://localhost:38080',  // ä»£ç†ç›®æ ‡
        changeOrigin: true,
      },
    },
  },
})
```

---

## ğŸ”§ å¸¸è§é—®é¢˜

### é—®é¢˜ 1ï¼šå‰ç«¯è¯·æ±‚å¤±è´¥ (CORS é”™è¯¯)

**é”™è¯¯ä¿¡æ¯**ï¼š
```
Access to fetch at 'http://localhost:38080/api/v1/tasks' from origin 'http://localhost:5173' has been blocked by CORS policy
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
æ£€æŸ¥åç«¯ `.env.development` ä¸­çš„ `CORS_ORIGIN` æ˜¯å¦åŒ…å« `http://localhost:5173`

### é—®é¢˜ 2ï¼šåç«¯æœªå¯åŠ¨

**é”™è¯¯ä¿¡æ¯**ï¼š
```
Failed to fetch
net::ERR_CONNECTION_REFUSED
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®è®¤åç«¯æ˜¯å¦è¿è¡Œï¼š`curl http://localhost:38080/health`
2. æ£€æŸ¥åç«¯ç»ˆç«¯æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯
3. é‡æ–°å¯åŠ¨åç«¯ï¼š`cd backend && npm run dev`

### é—®é¢˜ 3ï¼š401 æœªæˆæƒ

**è¯´æ˜**ï¼šè¿™æ˜¯æ­£å¸¸çš„ï¼æœªç™»å½•æ—¶è®¿é—®å—ä¿æŠ¤çš„ API ä¼šè¿”å› 401ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. å…ˆè®¿é—®ç™»å½•é¡µé¢
2. ä½¿ç”¨é»˜è®¤è´¦å·ç™»å½•ï¼ˆ`admin` / `admin123`ï¼‰
3. ç™»å½•åä¼šè·å¾— JWT token
4. åç»­è¯·æ±‚ä¼šè‡ªåŠ¨æºå¸¦ token

### é—®é¢˜ 4ï¼šæ•°æ®ä¸ºç©º

**å¯èƒ½åŸå› **ï¼š
- æ•°æ®åº“åˆšåˆå§‹åŒ–ï¼Œæ²¡æœ‰æ•°æ®
- éœ€è¦æ‰‹åŠ¨åˆ›å»ºä»»åŠ¡å’Œè´¦å·

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. å…ˆç»‘å®š Bilibili è´¦å·ï¼ˆè´¦å·ç®¡ç†é¡µé¢ï¼‰
2. åˆ›å»ºç›‘æ§ä»»åŠ¡ï¼ˆä»ªè¡¨ç›˜é¡µé¢ï¼‰
3. ç­‰å¾…è°ƒåº¦å™¨æ‰§è¡Œæ•°æ®é‡‡é›†

---

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
bili-stats-monitor-spec/
â”œâ”€â”€ backend/                 # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ .env.development    # å¼€å‘ç¯å¢ƒé…ç½®
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ routes/         # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ services/       # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â””â”€â”€ db/             # æ•°æ®åº“
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ frontend/web/           # å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ .env.development   # å¼€å‘ç¯å¢ƒé…ç½®
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”‚   â”œâ”€â”€ api.ts     # API å®¢æˆ·ç«¯
â”‚   â”‚   â”‚   â””â”€â”€ http.ts    # HTTP å·¥å…·
â”‚   â”‚   â””â”€â”€ pages/         # é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ vite.config.ts     # Vite é…ç½®ï¼ˆå« proxyï¼‰
â”‚   â””â”€â”€ package.json
â”‚
â””â”€â”€ å‰åç«¯å¯¹æ¥æŒ‡å—.md      # æœ¬æ–‡æ¡£
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥

1. âœ… åç«¯å·²è¿è¡Œåœ¨ 3000 ç«¯å£
2. âœ… å‰ç«¯å·²é…ç½®ä»£ç†åˆ°åç«¯
3. âœ… Mock æ•°æ®å·²ç¦ç”¨
4. â­ï¸ å¯åŠ¨å‰ç«¯æœåŠ¡å¹¶æµ‹è¯•
5. â­ï¸ ç™»å½•å¹¶å¼€å§‹ä½¿ç”¨åº”ç”¨

---

**åˆ›å»ºæ—¶é—´**: 2025-12-25  
**ç‰ˆæœ¬**: 1.0.0  
**çŠ¶æ€**: âœ… å·²å®Œæˆå¯¹æ¥é…ç½®

