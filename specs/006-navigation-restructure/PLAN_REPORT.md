# /speckit.plan æ‰§è¡Œå®ŒæˆæŠ¥å‘Š

**Feature**: 006-navigation-restructure  
**Date**: 2025-12-28  
**Status**: âœ… Phase 0 & Phase 1 å®Œæˆ

---

## æ‰§è¡Œæ‘˜è¦

`/speckit.plan` å‘½ä»¤å·²æˆåŠŸå®ŒæˆPhase 0ï¼ˆç ”ç©¶ï¼‰å’ŒPhase 1ï¼ˆè®¾è®¡ï¼‰ï¼Œç”Ÿæˆäº†å®Œæ•´çš„æŠ€æœ¯å®ç°è®¡åˆ’å’Œè®¾è®¡æ–‡æ¡£ã€‚

---

## ç”Ÿæˆçš„äº¤ä»˜ç‰©

### 1. Implementation Plan (`plan.md`)

**è·¯å¾„**: `specs/006-navigation-restructure/plan.md`

**å†…å®¹**:
- âœ… Technical Context (æŠ€æœ¯æ ˆã€æ€§èƒ½ç›®æ ‡ã€çº¦æŸ)
- âœ… Constitution Check (å®ªç« åˆè§„æ€§éªŒè¯ï¼Œå…¨éƒ¨é€šè¿‡)
- âœ… Project Structure (å‰ç«¯/åç«¯æ–‡ä»¶ç»“æ„)
- âœ… Complexity Tracking (æ— è¿åå®ªç« çš„å†³ç­–)
- âœ… Phase 0 & Phase 1 è¾“å‡ºè§„åˆ’
- âœ… Risk Mitigation (é£é™©ç¼“è§£ç­–ç•¥)
- âœ… Testing Strategy (æµ‹è¯•ç­–ç•¥)

---

### 2. Research Document (`research.md`)

**è·¯å¾„**: `specs/006-navigation-restructure/research.md`

**ç ”ç©¶æˆæœ**:

| ç ”ç©¶é¡¹ | å†³ç­– | å…³é”®æ–‡æ¡£ |
|-------|------|---------|
| **R1: æ•°æ®åº“è¿ç§»ç­–ç•¥** | ä¸¤é˜¶æ®µè¿ç§»(å…è®¸NULLâ†’æ•°æ®å›å¡«â†’çº¦æŸ) | è¿ç§»SQLã€å›å¡«è„šæœ¬ã€å›æ»šè®¡åˆ’ |
| **R2: æ•°æ®èšåˆæŸ¥è¯¢** | SQL GROUP BY + MAXèšåˆç²‰ä¸æ•° | æŸ¥è¯¢æ¨¡æ¿ã€Drizzle ORMå®ç°ã€ç´¢å¼•è®¾è®¡ |
| **R3: LocalStorage Fallback** | åŒæ­¥æ£€æŸ¥ + Toastæç¤º | useSelectedAccount Hookã€çŠ¶æ€æœºå›¾ã€æµ‹è¯•ç”¨ä¾‹ |
| **R4: è·¯ç”±çŠ¶æ€ç®¡ç†** | URLé©±åŠ¨ + useLocationç›‘å¬ | è·¯ç”±é…ç½®ã€Sidebarç»„ä»¶ã€åŠ¨ç”»å®ç° |

---

### 3. Data Model (`data-model.md`)

**è·¯å¾„**: `specs/006-navigation-restructure/data-model.md`

**æ•°æ®å˜æ›´**:
- **Tasksè¡¨æ‰©å±•**: 
  - `author_uid` (TEXT, å­˜å‚¨å‘å¸ƒè€…UID)
  - `bili_account_id` (TEXT, å­˜å‚¨æŸ¥è¯¢ç”¨è´¦å·ID)
  - ç´¢å¼•: `idx_tasks_author_uid`
- **Settingsè¡¨æ‰©å±•**:
  - æ–°è®°å½•: `default_account_id`
- **è¿ç§»è„šæœ¬**: SQLite + PostgreSQLåŒç‰ˆæœ¬
- **æ•°æ®æŠ“å–é€»è¾‘**: ä¸‰çº§ä¼˜å…ˆçº§(bili_account_id â†’ author_uid â†’ default)

---

### 4. API Contracts (`contracts/`)

**è·¯å¾„**: `specs/006-navigation-restructure/contracts/`

**æ–‡ä»¶**:
- `tasks-api.yaml`: æ‰©å±•Tasks APIï¼Œæ·»åŠ `author_uid`æŸ¥è¯¢å‚æ•°
- `authors-api.yaml`: æ–°å¢Authors APIï¼Œæä¾›ç²‰ä¸å†å²æ•°æ®

**æ–°å¢/ä¿®æ”¹ç«¯ç‚¹**:
- `GET /api/v1/tasks?author_uid=X` - æŒ‰ä½œè€…UIDç­›é€‰ä»»åŠ¡
- `GET /api/v1/authors/{uid}/metrics` - è·å–ç²‰ä¸å†å²æ•°æ®ï¼ˆèšåˆæŸ¥è¯¢ï¼‰

---

### 5. Quick Start Guide (`quickstart.md`)

**è·¯å¾„**: `specs/006-navigation-restructure/quickstart.md`

**å†…å®¹**:
- æ•°æ®åº“è¿ç§»æ­¥éª¤
- å¼€å‘æœåŠ¡å™¨å¯åŠ¨å‘½ä»¤
- åŠŸèƒ½æµ‹è¯•æŒ‡å—
- APIæµ‹è¯•ç¤ºä¾‹
- å¸¸è§é—®é¢˜æ’æŸ¥ï¼ˆ5ä¸ªQ&Aï¼‰
- å¼€å‘å»ºè®®

---

## Constitution Check ç»“æœ

| æ£€æŸ¥é¡¹ | çŠ¶æ€ | è¯´æ˜ |
|-------|------|------|
| **Front-End First** | âœ… PASS | é¡µé¢ç»“æ„ã€äº¤äº’æµç¨‹å·²è¯¦ç»†å®šä¹‰ |
| **API Contract** | âœ… PASS | Phase 1å·²å®Œæˆcontracts/ç›®å½• |
| **Bun Runtime** | âœ… PASS | æ‰€æœ‰ä¾èµ–Bunå…¼å®¹ |
| **Monorepo** | âœ… PASS | ç›®å½•ç»“æ„ç¬¦åˆè§„èŒƒ |
| **Incremental** | âœ… PASS | ç”¨æˆ·æ•…äº‹å¯ç‹¬ç«‹äº¤ä»˜ |
| **Layered Arch** | âœ… PASS | æœåŠ¡å±‚è®¾è®¡å·²æ˜ç¡® |

**Gate Result**: âœ… **PASS** - æ‰€æœ‰å®ªç« æ£€æŸ¥é¡¹é€šè¿‡

---

## æŠ€æœ¯å†³ç­–äº®ç‚¹

### æ•°æ®åº“è¿ç§»å®‰å…¨æ€§

- **ä¸¤é˜¶æ®µè¿ç§»**: é¿å…SQLiteä¸æ”¯æŒNOT NULLåˆ—çš„é™åˆ¶
- **æ•°æ®å›å¡«è„šæœ¬**: ä»Bç«™APIè·å–author_uidï¼Œå¸¦é‡è¯•å’Œé”™è¯¯å¤„ç†
- **å›æ»šè®¡åˆ’**: è¯¦ç»†çš„å¤‡ä»½å’Œæ¢å¤æ­¥éª¤

### æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–

- **ç´¢å¼•è®¾è®¡**: `idx_tasks_author_uid`æ”¯æŒæŒ‰ä½œè€…ç­›é€‰
- **èšåˆæŸ¥è¯¢**: GROUP BY + MAXå»é‡ç²‰ä¸æ•°æ®
- **æ€§èƒ½è¯„ä¼°**: é¢„è®¡æŸ¥è¯¢æ—¶é—´< 10ms (2,160è¡Œæ•°æ®)

### ç”¨æˆ·ä½“éªŒè®¾è®¡

- **LocalStorageæŒä¹…åŒ–**: è®°ä½ç”¨æˆ·è´¦å·é€‰æ‹©
- **ä¼˜é›…Fallback**: è´¦å·è§£ç»‘æ—¶è‡ªåŠ¨åˆ‡æ¢+Toastæç¤º
- **URLé©±åŠ¨çŠ¶æ€**: åˆ·æ–°é¡µé¢è‡ªåŠ¨å±•å¼€äºŒçº§èœå•

---

## æ–‡ä»¶æ¸…å•

```
specs/006-navigation-restructure/
â”œâ”€â”€ plan.md                      âœ… æŠ€æœ¯å®ç°è®¡åˆ’
â”œâ”€â”€ spec.md                      (å·²å­˜åœ¨)
â”œâ”€â”€ clarification-report.md      (å·²å­˜åœ¨)
â”œâ”€â”€ research.md                  âœ… ç ”ç©¶å†³ç­–æ–‡æ¡£
â”œâ”€â”€ data-model.md                âœ… æ•°æ®æ¨¡å‹è®¾è®¡
â”œâ”€â”€ quickstart.md                âœ… å¿«é€Ÿä¸Šæ‰‹æŒ‡å—
â”œâ”€â”€ contracts/
â”‚   â”œâ”€â”€ tasks-api.yaml          âœ… Tasks APIæ‰©å±•
â”‚   â””â”€â”€ authors-api.yaml        âœ… Authors APIæ–°å¢
â””â”€â”€ checklists/
    â””â”€â”€ requirements.md          (å·²å­˜åœ¨)
```

---

## Gitæäº¤è®°å½•

- **æ¾„æ¸…ä¼šè¯**: `b4998cd` - clarify: å®Œæˆ006-navigation-restructureéœ€æ±‚æ¾„æ¸…
- **æŠ€æœ¯è®¡åˆ’**: `1abadcb` - plan: å®Œæˆ006-navigation-restructureæŠ€æœ¯å®ç°è®¡åˆ’

---

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³æ‰§è¡Œ

```bash
/speckit.tasks
```

**ä½œç”¨**: å°†Phase 1çš„è®¾è®¡åˆ†è§£ä¸ºå¯æ‰§è¡Œçš„ä»»åŠ¡åˆ—è¡¨ï¼ˆ`tasks.md`ï¼‰ï¼ŒåŒ…æ‹¬ï¼š
- æ•°æ®åº“è¿ç§»ä»»åŠ¡ï¼ˆSQLè„šæœ¬ã€å›å¡«è„šæœ¬ï¼‰
- åç«¯APIå®ç°ä»»åŠ¡ï¼ˆAuthorServiceã€è·¯ç”±æ‰©å±•ï¼‰
- å‰ç«¯ç»„ä»¶å¼€å‘ä»»åŠ¡ï¼ˆMyAccountPageã€Sidebarã€Hooksï¼‰
- æµ‹è¯•ä»»åŠ¡ï¼ˆå•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ï¼‰

### å¼€å‘å‡†å¤‡

åœ¨æ‰§è¡Œ`/speckit.tasks`ä¹‹å‰ï¼Œå¼€å‘è€…å¯ä»¥ï¼š
1. é˜…è¯»`quickstart.md`ç†Ÿæ‚‰å¼€å‘æµç¨‹
2. å®¡æŸ¥`research.md`ç†è§£æŠ€æœ¯å†³ç­–
3. éªŒè¯æœ¬åœ°ç¯å¢ƒï¼ˆæ•°æ®åº“å¤‡ä»½ã€ä¾èµ–å®‰è£…ï¼‰

---

## è´¨é‡ä¿è¯

### æ–‡æ¡£å®Œæ•´æ€§

- âœ… æ‰€æœ‰Phase 0ç ”ç©¶é—®é¢˜å·²è§£å†³ï¼ˆR1-R4ï¼‰
- âœ… æ‰€æœ‰Phase 1è®¾è®¡æ–‡æ¡£å·²ç”Ÿæˆï¼ˆdata-modelã€contractsã€quickstartï¼‰
- âœ… å®ªç« åˆè§„æ€§å·²éªŒè¯ï¼ˆConstitution Checkå…¨éƒ¨é€šè¿‡ï¼‰
- âœ… Agentä¸Šä¸‹æ–‡å·²æ›´æ–°ï¼ˆCursor IDEï¼‰

### æŠ€æœ¯å¯è¡Œæ€§

- âœ… æ•°æ®åº“è¿ç§»ç­–ç•¥å·²éªŒè¯ï¼ˆSQLite + PostgreSQLåŒæ”¯æŒï¼‰
- âœ… æŸ¥è¯¢æ€§èƒ½å·²è¯„ä¼°ï¼ˆ< 10msï¼Œæ»¡è¶³< 2ç§’æ¸²æŸ“ç›®æ ‡ï¼‰
- âœ… APIè®¾è®¡å·²è§„èŒƒåŒ–ï¼ˆOpenAPI 3.0æ ¼å¼ï¼‰
- âœ… å‰ç«¯æ¶æ„å·²å¯¹é½ï¼ˆReact Router v6 + Zustandï¼‰

### é£é™©å·²ç¼“è§£

| é£é™© | ç¼“è§£æªæ–½ | çŠ¶æ€ |
|------|---------|------|
| æ•°æ®åº“è¿ç§»å¤±è´¥ | å¤‡ä»½+å›æ»šè®¡åˆ’ | âœ… å·²æ–‡æ¡£åŒ– |
| æŸ¥è¯¢æ€§èƒ½é—®é¢˜ | ç´¢å¼•+è¯„ä¼° | âœ… å·²ä¼˜åŒ– |
| LocalStorageå¤±æ•ˆ | Fallbacké€»è¾‘ | âœ… å·²è®¾è®¡ |
| è·¯ç”±çŠ¶æ€ä¸åŒæ­¥ | URLé©±åŠ¨ | âœ… å·²ç®€åŒ– |

---

## ç»Ÿè®¡æ•°æ®

- **ç”Ÿæˆæ–‡ä»¶æ•°**: 6ä¸ªï¼ˆplan, research, data-model, quickstart, 2Ã— contractsï¼‰
- **æ€»å­—æ•°**: ~15,000å­—
- **ä»£ç ç¤ºä¾‹**: 20+æ®µ
- **æŠ€æœ¯å†³ç­–**: 9ä¸ªï¼ˆ4ä¸ªç ”ç©¶ + 5ä¸ªè®¾è®¡ï¼‰
- **APIç«¯ç‚¹**: 2ä¸ªæ–°å¢/æ‰©å±•
- **æ•°æ®åº“å˜æ›´**: 3ä¸ªå­—æ®µ + 1ä¸ªç´¢å¼• + 1æ¡è®°å½•

---

**Status**: âœ… **Phase 0 & Phase 1 å®Œæˆï¼Œå‡†å¤‡è¿›å…¥Phase 2ï¼ˆä»»åŠ¡åˆ†è§£ï¼‰**

æ‰§è¡Œ`/speckit.tasks`ç»§ç»­ä¸‹ä¸€é˜¶æ®µï¼ğŸš€

