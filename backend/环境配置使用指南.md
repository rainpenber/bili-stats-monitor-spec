# ç¯å¢ƒé…ç½®ä½¿ç”¨æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬é¡¹ç›®æ”¯æŒä¸¤å¥—ç‹¬ç«‹çš„ç¯å¢ƒé…ç½®ï¼š
- **å¼€å‘ç¯å¢ƒ** (Development)ï¼šç”¨äºæœ¬åœ°å¼€å‘è°ƒè¯•
- **ç”Ÿäº§ç¯å¢ƒ** (Production)ï¼šç”¨äºç”Ÿäº§éƒ¨ç½²

æ¯ä¸ªç¯å¢ƒä½¿ç”¨ç‹¬ç«‹çš„é…ç½®æ–‡ä»¶ï¼Œäº’ä¸å¹²æ‰°ã€‚

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å¼€å‘ç¯å¢ƒ

```bash
cd backend
npm run dev
```

### ç”Ÿäº§ç¯å¢ƒ

```bash
cd backend
npm run start
```

---

## ğŸ“ é…ç½®æ–‡ä»¶

### `.env.development` - å¼€å‘ç¯å¢ƒé…ç½®
- **æ•°æ®åº“**: `./data/dev/bili-stats-dev.db`
- **ç«¯å£**: 3000
- **æ—¥å¿—çº§åˆ«**: debug
- **CORS**: å…è®¸ localhost:5173, localhost:5174
- **ç‰¹æ€§**: çƒ­é‡è½½ã€è¯¦ç»†é”™è¯¯ã€APIæ—¥å¿—è®°å½•

### `.env.production` - ç”Ÿäº§ç¯å¢ƒé…ç½®
- **æ•°æ®åº“**: `./data/prod/bili-stats.db`
- **ç«¯å£**: 8080
- **æ—¥å¿—çº§åˆ«**: info
- **CORS**: éœ€è¦é…ç½®å®é™…åŸŸå
- **ç‰¹æ€§**: å¢å¼ºå®‰å…¨ã€æ€§èƒ½ä¼˜åŒ–

---

## ğŸ”§ é…ç½®è¯´æ˜

### å¿…éœ€é…ç½®é¡¹

```bash
# JWT å¯†é’¥ï¼ˆå¿…éœ€ï¼Œè‡³å°‘32å­—ç¬¦ï¼‰
JWT_SECRET=your-secret-key-here

# æ•°æ®åŠ å¯†å¯†é’¥ï¼ˆå¿…éœ€ï¼Œ64ä¸ªåå…­è¿›åˆ¶å­—ç¬¦ï¼‰
ENCRYPT_KEY=your-encrypt-key-here
```

### æ•°æ®åº“é…ç½®

#### ä½¿ç”¨ SQLiteï¼ˆé»˜è®¤ï¼‰
```bash
DB_TYPE=sqlite
SQLITE_PATH=./data/dev/bili-stats-dev.db
```

#### ä½¿ç”¨ PostgreSQL
```bash
DB_TYPE=postgres
DATABASE_URL=postgresql://user:password@localhost:5432/dbname
```

---

## ğŸ› ï¸ å¸¸ç”¨å‘½ä»¤

### å¼€å‘ç¯å¢ƒ
```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# åˆå§‹åŒ–å¼€å‘æ•°æ®åº“
bunx drizzle-kit push:sqlite --schema ./src/db/schema.ts --url ./data/dev/bili-stats-dev.db

# ç”Ÿæˆå¯†é’¥
npm run generate-secret
```

### ç”Ÿäº§ç¯å¢ƒ
```bash
# å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
npm run start

# åˆå§‹åŒ–ç”Ÿäº§æ•°æ®åº“
bunx drizzle-kit push:sqlite --schema ./src/db/schema.ts --url ./data/prod/bili-stats.db
```

---

## ğŸ” å®‰å…¨æ€§å»ºè®®

### å¼€å‘ç¯å¢ƒ
- âœ… ä½¿ç”¨å›ºå®šçš„å¯†é’¥ï¼Œæ–¹ä¾¿å›¢é˜Ÿåä½œ
- âœ… é…ç½®æ–‡ä»¶å·²æ·»åŠ åˆ° `.gitignore`
- âš ï¸ ä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨å¼€å‘ç¯å¢ƒçš„å¯†é’¥

### ç”Ÿäº§ç¯å¢ƒ
- ğŸ”’ **å¿…é¡»**ç”Ÿæˆå¼ºéšæœºå¯†é’¥
- ğŸ”’ **å¿…é¡»**ä¿®æ”¹é»˜è®¤ç®¡ç†å‘˜å¯†ç 
- ğŸ”’ **å¿…é¡»**é…ç½®æ­£ç¡®çš„ CORS åŸŸå
- ğŸ”’ **å¿…é¡»**ä½¿ç”¨ HTTPS
- ğŸ”’ **ä¸è¦**æäº¤ç”Ÿäº§ç¯å¢ƒé…ç½®åˆ° Git

---

## ğŸ“ é…ç½®æ¨¡æ¿

æŸ¥çœ‹ `env-template.txt` äº†è§£æ‰€æœ‰å¯ç”¨çš„é…ç½®é€‰é¡¹ã€‚

---

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜ï¼šå¯åŠ¨æ—¶æç¤º"Database tables not found"
**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# ç¡®ä¿å·²åˆ›å»ºæ•°æ®åº“è¡¨
bunx drizzle-kit push:sqlite --schema ./src/db/schema.ts --url ./data/dev/bili-stats-dev.db
```

### é—®é¢˜ï¼šç«¯å£è¢«å ç”¨
**è§£å†³æ–¹æ¡ˆ**ï¼š
ä¿®æ”¹ `.env.development` æˆ– `.env.production` ä¸­çš„ `PORT` é…ç½®ã€‚

### é—®é¢˜ï¼šJWT_SECRET éªŒè¯å¤±è´¥
**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# ç”Ÿæˆæ–°çš„å¯†é’¥
npm run generate-secret
# å°†ç”Ÿæˆçš„å¯†é’¥å¤åˆ¶åˆ°é…ç½®æ–‡ä»¶ä¸­
```

---

## ğŸ“š æ›´å¤šä¿¡æ¯

- è¯¦ç»†æ–‡æ¡£ï¼š`docs/ENVIRONMENT_SETUP.md`
- å¿«é€Ÿå¯åŠ¨ï¼š`ENVIRONMENT_QUICKSTART.md`
- é…ç½®æ¨¡æ¿ï¼š`env-template.txt`

---

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### å¼€å‘ç¯å¢ƒç‰¹æ€§
- ğŸ”¥ çƒ­é‡è½½
- ğŸ“Š è¯¦ç»†é”™è¯¯å †æ ˆ
- ğŸ“ API è¯·æ±‚æ—¥å¿—
- ğŸ› æ€§èƒ½ç›‘æ§
- ğŸ­ å¯é€‰æ¨¡æ‹Ÿæ•°æ®

### ç”Ÿäº§ç¯å¢ƒç‰¹æ€§
- ğŸ”’ å¢å¼ºçš„å®‰å…¨æ€§
- âš¡ æ€§èƒ½ä¼˜åŒ–
- ğŸ“Š ç²¾ç®€æ—¥å¿—
- ğŸ›¡ï¸ é™åˆ¶çš„ CORS
- ğŸš« å…³é—­è°ƒè¯•åŠŸèƒ½

---

**éœ€è¦å¸®åŠ©ï¼Ÿ** æŸ¥çœ‹é¡¹ç›®æ–‡æ¡£æˆ–è”ç³»å›¢é˜Ÿæˆå‘˜ã€‚

